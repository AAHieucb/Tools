# Basic
T∆∞∆°ng t√°c v·ªõi repo qua API ƒë∆∞·ª£c: https://docs.github.com/en/rest/repos?apiVersion=2022-11-28#create-a-repository-dispatch-event

-> Events ---trigger---> Workflows ---Use---> Actions
C√°c event c√≥ th·ªÉ trigger: https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#push
Th∆∞·ªùng d√πng push, pull_request, public, schedule (t·ª± ƒë·ªông ch·∫°y sau 1 kho·∫£ng tg), workflow_dispatch (trigger 1 actions th·ªß c√¥ng qua 1 n√∫t, c√≥ th·ªÉ bi·∫øn th√†nh api ƒë·ªÉ call t·ª´ xa)

C√≥ nhi·ªÅu actions v√† workflow c√≥ s·∫µn c√≥ th·ªÉ d√πng. C√≥ th·ªÉ vi·∫øt actions b·∫±ng b·∫•t c·ª© ng√¥n ng·ªØ n√†o mi·ªÖn c√≥ th·ªÉ compiled ra JS, t·ªëi thi·ªÉu ph·∫£i c√≥ 2 file l√† index.js v√† action.yml config cho ch·∫°y index.js. N√™n chia nh·ªè v√† k t·∫°o 1 action l√†m qu√° nhi·ªÅu th·ª© v√¨ r·∫•t kh√≥ debug c≈©ng nh∆∞ khi th√™m b·ªõt c√°c step t√≠nh nƒÉng m·ªõi s·∫Ω ph·∫£i vi·∫øt l·∫°i actions
C√≥ th·ªÉ t·ª± t·∫°o actions v√† cho l√™n marketplace. 1 actions c√≥ th·ªÉ pull code t·ª´ git hay setup c√°c tool chain l·ªõn. VD marketplace c√≥ s·∫µn c√°c actions nh∆∞ setup java jdk, setup .net core sdk, setup go evironment.
Khi t·∫°o actions v√† nhi·ªÅu ng∆∞·ªùi kh√°c d√πng n√≥, xong ta code s·ª≠a ƒë·ªïi actions th√¨ n√™n t·∫°o ra version m·ªõi cho n√≥. Tr√°nh nh·ªØng ng∆∞·ªùi kh√°c ch·∫°y action version l·ªói khi d√πng v·ªõi version code c·ªßa repo hi·ªán t·∫°i. VD b√°o r·∫±ng 1 acion n√†y d√πng v·ªõi repo nh√°nh c√≥ version v1.0.0:
steps:
  - name: My Action Step
    uses: owner/repo@v1.0.0
=> Th∆∞·ªùng c√≥ docs cho github actions b√°o nh·ªØng tham s·ªë c·∫ßn ƒëi·ªÅn hay version c·ªßa actions

K·∫øt h·ª£p docker th√¨ ch·ªâ ch·∫°y ƒë∆∞·ª£c tr√™n linux vm c·ªßa github actions.
C√≥ th·ªÉ d√πng secret or bi·∫øn global trong ph·∫°m vi repo hay organization 1 nh√≥m c√°c projects ƒë·ªÅu ƒë∆∞·ª£c.



//!!!!!!!!!
# T·ªïng h·ª£p syntax basic cho file yml 
URL: https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#on

name: CI
on:
  push:
    branches: [ "main" ]
  push: 
    branches:
      - develop
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:
  repository_dispatch: 
    types: [MyCustomEventName]
jobs:
  build:
    name: Install something
    runs-on: ubuntu-latest
    strategy:
      matrix: 
        node-version: [10.x]
    steps:
      - uses: actions/checkout@v3
      - name: Run a one-line script ${{matrix.node-version}}
        uses: actions/setup-node@v1
        with:
          node-version: ${{matrix.node-version}}
        run: |
          echo Add other actions to build,
          echo test, and deploy your project.
          echo ${{github.event.client_payload.paramA}}
        env: 
          CI: true
          GITHUB_TOKEN: ${{secrets.SOMETHING_ELSE}}
        if: ${{ 'aaa' = 'aaa' }}
      - uses: actions/upload-artifact@master
        with:
          name: webpack artifacts
          path: public/
  deploy:
    runs-on: ubuntu-latest
    needs: [build]
    if: github.event.ref == 'refs/heads/main'
    if: github.event_name == 'pull_request'
    environment: 
      name: Development
      url: "http://dev.myapp.com"
    steps:
      - uses: actions/checkout@v3
      - name: Run test
        run: echo Test is ${{secrets.MY_SECRET}}
        if: ${{env.arg1 == env.arg2}}
      - name: Test repo dispatch 
        uses: peter-evans/repository_dispatch@v1.1.2
        with: 
          token: ${{ secret.REPO.PAT }}
          event-type: MyCustomEventName
          client-payload: '{"testboolean": 123}'

- ·ªû ƒë√¢y c√≥ d√πng actions/upload-artifact@master ƒë·ªÉ upload artifact sinh ra b·ªüi webpack. Sau khi generate, artifact s·∫Ω l∆∞u trong th∆∞ m·ª•c public, n√≥ c≈©ng d√πng ƒë·ªÉ l∆∞u bundled JS file, optimized CSS file ·∫•y.
- Sau with c√≥ th·ªÉ l√† b·∫•t c·ª© th·ª© g√¨ t√πy v√†o actions, n√≥ cung options cho actions hi·ªán t·∫°i

C∆° ch·∫ø basic l√† ƒë·ªãnh nghƒ©a ƒëi·ªÅu ki·ªán ch·∫°y workflow n√†y v·ªõi on
ƒê·ªãnh nghƒ©a c√°c jobs v√† m·ªói jobs c√≥:
  c√°c ƒëi·ªÅu ki·ªán ƒë·ªÉ ch·∫°y ƒë∆∞·ª£c jobs
  t·ª´ng steps th·ª±c hi·ªán jobs:
    M·ªói steps c√≥ th·ªÉ use c√°c package
    with ƒë·ªÉ th√™m params cho c√°c package s·ª≠ d·ª•ng
    run ƒë·ªÉ c·ª• th·ªÉ vi·ªác ch·∫°y l·ªánh n√†o

-> VD c·∫•u h√¨nh workflow events: 1 event c√≥ th·ªÉ trigger 1 workflow khi n√≥ x·∫£y ra tr√™n repo v√† tr·∫£ v·ªÅ 1 commithash v√† git ref. VD:

on: push 

on: [push, pull_request] 

on: 
  push: 
    branches: 
      - main
  pull_request: 
    branches: 
      - main
  page_build:
  release:
    types:
      - created
=> Trong github c√≥ c√°i g·ªçi l√† Github Pages cho ph√©p user host v√† publish static websites tr·ª±c ti·∫øp t·ª´ repo. K·∫øt h·ª£p v·ªõi CI/CD th√¨ thay ƒë·ªïi code repo l√† github t·ª± build v√† host l√™n cho ta. V·ªõi domain c√≥ s·∫µn, n√≥ free. ·ªû ƒë√¢y page_build b·∫Øt s·ª± ki·ªán khi c√≥ code thay ƒë·ªïi v√† Github Pages rebuild l·∫°i websites.
=> Release created event l√† khi 1 b·∫£n release m·ªõi ƒë∆∞·ª£c ph√°t h√†nh. Ta c√≥ th·ªÉ trigger b·∫±ng c√°ch ·∫•n n√∫t Releases trong repo. M·ªói release t∆∞∆°ng ·ª©ng 1 version m·ªõi ƒë∆∞·ª£c ph√°t h√†nh

on:
  push:
    paths-ignore:
    - 'docs/**'
=> B·∫Øt event push khi code ƒë·ªïi nh∆∞ng tr·ª´ folder docs thay ƒë·ªïi th√¨ k t√≠nh. Ng∆∞·ª£c v·ªõi:
on:
  push:
    paths:
    - '**.js'

--> Trigger workflow theo schedule ƒë·ªãnh s·∫µn b·∫±ng POSIX cron syntax:
on:
  schedule:
    - cron:  '*/15 * * * *' // th·ª±c hi·ªán trigger m·ªói 15 ph√∫t
=> N√≥ s·∫Ω th·ª±c thi tr√™n sources c·ªßa commit m·ªõi nh·∫•t c·ªßa default branch. C√∫ ph√°p Cron syntax c√≥ 5 tr∆∞·ªùng ngƒÉn kho·∫£ng tr·∫Øng:
<Ph√∫t> <gi·ªù> <ng√†y trong th√°ng> <th√°ng> <ng√†y trong tu·∫ßn>
To√°n t·ª≠: 
* l√† t·∫•t c·∫£ gi√° tr·ªã;

, l√† gi√° tr·ªã trong danh s√°ch
VD: 2,10 4,5 * * * l√† ch·∫°y ·ªü ph√∫t th·ª© 2, 10 v√† gi·ªù th·ª© 4,5 c·ªßa m·ªçi ng√†y 

- l√† kho·∫£ng gi√° tr·ªã
VD: 0 4-6 * * * => m·ªói 0 ph√∫t, t·ª´ 4-6 gi·ªù c·ªßa m·ªçi ng√†y

/ l√† b∆∞·ªõc nh·∫£y gi√° tr·ªã
VD: 20/15 * * * * l√† ch·∫°y m·ªói 15 ph√∫t t·ª´ ph√∫t th·ª© 20 m·ªói gi·ªù (t·ª©c ch·∫°y ·ªü c√°c ph√∫t 20, 35, 50 c·ªßa m·ªói gi·ªù)

=> C√≤n r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ trigger workflow nh∆∞ t·∫°o comment hay x√≥a branch,...

-> Jobs: c√≥ th·ªÉ l√† 1 script do ta vi·∫øt or 1 action
M·ªói job ƒë∆∞·ª£c ch·∫°y trong 1 virual machine runner or 1 container ri√™ng.
Event -> Runner1[Job1[run action -> run script -> run action]] -> Runner2[Job2[run action -> run script]]
=> Default c√°c job s·∫Ω run parallel, ta c√≥ th·ªÉ setup run tu·∫ßn t·ª±. 

--> Runner l√† 1 server m√°y ·∫£o ch·∫°y c√°i workflow, c√≥ s·∫µn ƒë·ªß linux, window, macos. N·∫øu ta c·∫ßn c√°c ƒëi·ªÅu ki·ªán ph·∫ßn c·ª©ng ph·ª©c t·∫°p c√≥ th·ªÉ host ri√™ng 1 runner. 1 runner ch·ªâ ch·∫°y ƒë∆∞·ª£c 1 job 1 l√∫c.

-> C√≥ th·ªÉ t·∫°o workflow d√πng github actions b·∫•t c·ª© l√∫c n√†o b·∫±ng c√°ch t·∫°o file .yaml ƒë·∫∑t trong .github/workflows
Khi c√≥ workflow, github actions s·∫Ω check code ƒë∆∞·ª£c pushed v√† c√†i BATS(Bash Automated Testing System) testing framework r·ªìi ch·∫°y command hi·ªÉn th·ªã version: bats -v



--> Matrix build gi√∫p vi·∫øt code 1 l·∫ßn m√† ch·∫°y build nhi·ªÅu l·∫ßn ch·∫°y tr√™n c√°c n·ªÅn t·∫£ng v√† version kh√°c nhau theo tham s·ªë truy·ªÅn v√†o. 
name: Node CI
on: [push]  # B·∫Øt event push
jobs: 
  build: 
    runs-on: ${{ matrix.os }}  # Bu·ªôc c√≥ runs-on ƒë·ªÉ bi·∫øt ch·∫°y tr√™n n·ªÅn t·∫£ng n√†o
    strategy:
      matrix:  # VD 1 job t·ª± ƒë·ªông build l·∫°i 9 l·∫ßn m·ªói khi push code (3 os, 3 version nodejs)
        node-version: [8.x, 10.x, 12.x]
        os: [macos-latest, window-latest, ubuntu-18.04]
    steps:
    - uses: actions/checkout@v1
    - name: Use Node.JS ${{ matrix.node-version }}
      uses: actions/setup-node@v1  # D√πng actions c√≥ s·∫µn, actions n√†y gi√∫p setup ·ª©ng d·ª•ng nodejs
      with: 
        node-version: ${{ matrix.node-version }}
    - name: npm install, build and test
      run: |  # Ch·∫°y shell-script
        npm ci
        npm run build --if-present
        npm test
      env: 
        CI: true
=> ·ªû ƒë√¢y ch·ªâ c√≥ 1 job l√† build, c√≥ th·ªÉ t·∫°o nhi·ªÅu jobs. C√°c jobs s·∫Ω t·ª± ch·∫°y song song, n·∫øu mu·ªën theo th·ª© t·ª± th√¨ th√™m tr∆∞·ªùng needs v√†o. VD d√πng linux s·∫Ω t·ª± d√πng github hosted runner for linux.
=> ref t·ªõi actions public c·ªßa ng∆∞·ªùi kh√°c th√¥ng qua: <user>/<name of repo>@v<version>. VD: actions/setup-node@v1   

--> Starter workflow: workflow c√≥ s·∫µn ƒë·ªÉ d√πng ti·∫øp k c·∫ßn t·∫°o t·ª´ scratch. Ch·ªçn t·ª´ tab Actions c·ªßa github
VD: "Simple workflow" ch·ª©a minimal m·ªçi th·ª© c·∫ßn ƒë·ªÉ setup, r·ªìi ch·ªçn ƒë·ªß lo·∫°i actions c√≥ s·∫µn th√™m v√†o t·ª´ marketplace online ngay trong tab Actions c·ªßa github

Th√¥ng th∆∞·ªùng trong m·ªçi steps job ƒë·ªÅu c√≥: - uses: actions/checkout@v3
=> Lu√¥n d√πng, n√≥ s·∫Ω checkout repo v√†o runner ƒë·ªÉ th·ª±c hi·ªán workflow. Nch l√† bu·ªôc c√≥ ƒë·ªÉ workflow access v√†o code trong repo m√† th·ª±c hi·ªán ch·ª©

-> M√£trisx build c√≥ th·ªÉ ph∆∞ucs t·∫°p:
Matrix build trong GitHub Actions gi√∫p b·∫°n ch·∫°y c√πng m·ªôt job v·ªõi nhi·ªÅu bi·∫øn ƒë·∫ßu v√†o kh√°c nhau ‚Äî nh∆∞ ch·∫°y tr√™n nhi·ªÅu phi√™n b·∫£n Node.js, nhi·ªÅu h·ªá ƒëi·ªÅu h√†nh, ho·∫∑c nhi·ªÅu c·∫•u h√¨nh kh√°c nhau ‚Äî m√† kh√¥ng ph·∫£i vi·∫øt l·∫°i code l·∫∑p ƒëi l·∫∑p l·∫°i.

üîπ C·∫•u tr√∫c c∆° b·∫£n c·ªßa matrix
yaml
Sao ch√©p
Ch·ªânh s·ª≠a
jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node: [14, 16, 18]
    steps:
      - uses: actions/checkout@v2
      - name: Use Node.js ${{ matrix.node }}
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node }}
      - run: npm install
      - run: npm test
‚úÖ ƒêi·ªÅu g√¨ ƒëang x·∫£y ra?
B·∫°n ch·ªâ vi·∫øt 1 job duy nh·∫•t, nh∆∞ng GitHub s·∫Ω t·ª± ƒë·ªông l·∫∑p l·∫°i job ƒë√≥ cho t·ª´ng gi√° tr·ªã trong matrix.node.

K·∫øt qu·∫£: job test s·∫Ω ch·∫°y 3 l·∫ßn, t∆∞∆°ng ƒë∆∞∆°ng:

node: 14

node: 16

node: 18

üëâ M·ªói l·∫ßn ch·∫°y l√† m·ªôt m√¥i tr∆∞·ªùng ri√™ng bi·ªát, song song.

üîπ Matrix nhi·ªÅu chi·ªÅu (nhi·ªÅu bi·∫øn)
yaml
Sao ch√©p
Ch·ªânh s·ª≠a
strategy:
  matrix:
    os: [ubuntu-latest, windows-latest]
    node: [16, 18]
‚û°Ô∏è GitHub s·∫Ω t·∫°o 4 t·ªï h·ª£p:

os	node
ubuntu-latest	16
ubuntu-latest	18
windows-latest	16
windows-latest	18

üîπ Lo·∫°i b·ªè t·ªï h·ª£p kh√¥ng h·ª£p l·ªá (exclude / include)
B·∫°n c√≥ th·ªÉ lo·∫°i tr·ª´ t·ªï h·ª£p kh√¥ng mu·ªën ch·∫°y:

yaml
Sao ch√©p
Ch·ªânh s·ª≠a
strategy:
  matrix:
    os: [ubuntu-latest, windows-latest]
    node: [16, 18]
    exclude:
      - os: windows-latest
        node: 18
‚û°Ô∏è T·ªï h·ª£p windows-latest + node 18 s·∫Ω b·ªã b·ªè qua.

Ho·∫∑c th√™m gi√° tr·ªã ƒë·∫∑c bi·ªát ch·ªâ cho m·ªôt t·ªï h·ª£p:

yaml
Sao ch√©p
Ch·ªânh s·ª≠a
strategy:
  matrix:
    os: [ubuntu-latest, windows-latest]
    node: [16, 18]
    include:
      - os: ubuntu-latest
        node: 18
        extra_flag: true

üîπ Khi n√†o n√™n d√πng matrix?
Test tr√™n nhi·ªÅu phi√™n b·∫£n Node/Python/Java...

Test tr√™n nhi·ªÅu h·ªá ƒëi·ªÅu h√†nh (Ubuntu / Windows / macOS)

Ki·ªÉm tra nhi·ªÅu c·∫•u h√¨nh / bi·∫øn m√¥i tr∆∞·ªùng



# Debug 
C√≥ th·ªÉ xem log trong github

D√πng secret ACTIONS_STEP_DEBUG. VD:
steps:
  - name: My Step
    run: echo "Hello, World!"
    env:
      ACTIONS_STEP_DEBUG: true
=> S·∫Ω show chi ti·∫øt th√¥ng tin debug c·ªßa t·ª´ng b∆∞·ªõc, show warning v√† l·ªói chi ti·∫øt. N√≥ t·∫°o nhi·ªÅu output ƒë·∫ßu ra n√™n ch·ªâ d√πng khi th·ª±c s·ª± c·∫ßn.

D√πng github actions extension c·ªßa VS s·∫Ω t·ª± check l·ªói logic v√† ch·ªâ d·∫´n cho file yml. N√≥ ch·ªâ ho·∫°t ƒë·ªông khi file yml ƒë·∫∑t trong ƒë√∫ng folder .github\workflows => n√™n d√πng

-> Trong github actions c√≥ Super-Linter l√† repo gi√∫p check faulty code c·ªßa ƒë·ªß lo·∫°i ng√¥n ng·ªØ m√† github h·ªó tr·ª£. Vi·ªác check b·∫±ng super linter tr∆∞·ªõc khi commit gi√∫p tr√°nh c√°c l·ªói c∆° b·∫£n => c≈©ng k c·∫ßn thi·∫øt m·∫•y v√¨ thg build th√†nh c√¥ng m·ªõi push code ch·ª©
VD d√πng:
- name: Run Super-Linter
        uses: github/super-linter@v4
        env:
          VALIDATE_ALL_CODEBASE: true
=> ƒê·ªÉ ch·∫°y super linter tr∆∞·ªõc khi th·ª±c hi·ªán ti·∫øp c√°i kh√°c b√™n d∆∞·ªõi



# Environment
Ta c√≥ th·ªÉ ph√¢n chia m√¥i tr∆∞·ªùng Dev, QA, PreProd, Prod. M·ªói m√¥i tr∆∞·ªùng c√≥ bi·∫øn secret ri√™ng v√† k ·∫£nh h∆∞·ªüng l·∫´n nhau.

Protection rules gi√∫p x√°c ƒë·ªãnh ƒëk, VD ch·ªâ deploy khi admin cho ph√©p, ch·ªâ deploy v·ªõi code ·ªü 1 branch c·ª• th·ªÉ, t√≠ch h·ª£p th√™m c√°c API c·ªßa b√™n th·ª© 3, wait timer,... Theo d√µi t·∫•t c·∫£ trong Deployments Activity log

Environment ·ªü tr·∫°ng th√°i waiting t·ª©c ƒëang ch·ªù approval, inactive l√† ch∆∞a ch·∫°y l·∫ßn n√†o, active l√† ƒë√£ ch·∫°y, queued l√† ƒëang ch·∫°y 

-> D√πng environment:
- Tab settings c·ªßa repo ho·∫∑c organization. Ch·ªâ c√≥ trong public repo ho·∫∑c enterprise private repo
- Th√™m config protection rules
- Ch·ªçn branch c√≥ th·ªÉ d√πng ki·ªÉu: release/* th√¨ m·ªçi branch prefix release/ s·∫Ω c√≥ th·ªÉ deploy v√†o env n√†y
- T·∫°o 1 job c√≥ ki·ªÉu:
environment: 
  name: Development
  url: "http://dev.myapp.com"
s·∫Ω t·ª± deploy v√†o m√¥i tr∆∞·ªùng Development t·∫°o t·ª´ tr∆∞·ªõc v√† deploy v·ªõi domain url ph·∫£i b·∫Øt ƒë·∫ßu b·∫±ng http/https. C√≥ c√°ch d√πng dynamic url m√† k fix c·ª©ng nh∆∞ n√†y
=> T·ª©c l√† b√™n c·∫°nh c√°c ƒëk if v√† needs, d√πng environment ch·ªâ l√† ƒë·ªÉ th√™m ƒëi·ªÅu ki·ªán protection rules n·ªØa v√†o th√¥i. M·ªói env c√≥ 1 protection rules gi√∫p ta ch·ªçn protection rule n√†o ok



# Self-hosted runner
-> Github hosted runner l√† m√°y ·∫£o cung c·∫•p b·ªüi github ƒë·ªÉ ch·∫°y c√°c quy tr√¨nh c·ªßa github actions. N√≥ cung c√°c lo·∫°i runner kh√°c nhau nh∆∞ ubuntu, windows, macOs.
M·ªói job ch·∫°y tr√™n 1 runner

B·∫£n mi·ªÖn ph√≠ ƒë∆∞·ª£c d√πng ch·∫°y free tr√™n m√°y ·∫£o 2000 ph√∫t 1 th√°ng. 
Github hosted runner ƒë∆∞·ª£c qu·∫£n l√Ω b·ªüi github. N√≥ t·ª± ƒë·ªông clear h·∫øt m·ªçi instance sau khi th·ª±c hi·ªán t·ª´ng job xong. ƒêi·ªÅu n√†y gi√∫p t·ªëi ∆∞u nh∆∞ng c≈©ng b·∫•t ti·ªán v√¨ n·∫øu ta t·∫£i c√°c file v·ªÅ m√°y ·∫£o, l·∫ßn sau ch·∫°y n√≥ ph·∫£i t·∫£i l·∫°i v√† l·∫∑p l·∫°i quy tr√¨nh t·ª´ ƒë·∫ßu

-> Ta c√≥ th·ªÉ ch·∫°y github actions tr√™n self hosted runner l√† m√°y ·∫£o ch·∫°y tr√™n h·∫° t·∫ßng c·ªßa ta. T·ª´ ƒë√≥ ta c√≥ th·ªÉ qu·∫£n l√Ω ho√†n to√†n m√°y ch·ªß v√† customize ƒë·ªß th·ª©. 
K n√™n d√πng self hosted runner cho public repo v√¨ ng∆∞·ªùi ngo√†i c√≥ th·ªÉ l·ª£i d·ª•ng n√≥, n·∫øu d√πng n√™n th√™m firewall v√† ip allowed list cho an to√†n.
VD: n·∫øu ta build 1 application c·∫ßn d√πng ƒë·∫øn GPU ch·∫≥ng h·∫°n m√† github hosted runner k c√≥ th√¨ ta ph·∫£i t·ª± setup self hosted runner c√≥ GPU c·ªßa ta. 

--> ƒê·ªÉ t·∫°o self hosted runner: Github cung s·∫µn script ch·ªâ c·∫ßn t·∫£i v·ªÅ v√† ch·∫°y tr√™n self hosted VM, r·ªìi config authentication v·ªõi token l√† n√≥ s·∫Ω l·∫Øng nghe c√°c event t·ª´ repo ƒë·ªÉ th·ª±c hi·ªán jobs t∆∞∆°ng ·ª©ng th√¥i. URL: https://docs.github.com/en/actions/hosting-your-own-runners
VM selft hosted ph·∫£i ƒë·∫£m b·∫£o c√†i ƒë·∫ßy ƒë·ªß c√°c framework, dependency c·∫ßn thi·∫øt ch·∫°y ·ª©ng d·ª•ng m√† ta ph·∫£i setup th·ªß c√¥ng.

-> Khi c√≥ nhi·ªÅu self hosted runner, c√≥ th·ªÉ gom th√†nh 1 runner group. Vd group chia theo t·ª´ng ƒë·ªôi dev, chia theo repo v√† organization hay nh√≥m c√°c runner linux l·∫°i v·ªõi nhau. Ta c√≥ th·ªÉ ch·∫°y 1 runner v·ª´a build .net app, v·ª´a build nodejs app nh∆∞ng n√™n t√°ch ra.
N√™n c·∫•u h√¨nh dedicated user cho runner v√¨ c√≥ c√°c actions c·∫ßn l·ªánh sudo, c√≥ actions kh√¥ng c·∫ßn, ta n√™n ph√¢n quy·ªÅn cho nh·ªØng user n√†o ƒë∆∞·ª£c quy·ªÅn ch·∫°y c√°c actions t∆∞∆°ng ·ª©ng. 



# Secrets
-> C√°c bi·∫øn c√≥ s·∫µn c·ªßa github
GITHUB_TOKEN l√† bi·∫øn secret d√πng ƒë·ªÉ t∆∞∆°ng t√°c v·ªõi repo, n√≥ c√≥ th·ªÉ truy c·∫≠p b·ªüi m·ªçi actions. N√≥ t·ª± ƒë·ªông ƒë∆∞·ª£c thay ƒë·ªïi li√™n t·ª•c khi d√πng ƒë·ªÉ b·∫£o m·∫≠t n√™n c√≥ b·∫Øt ƒë∆∞·ª£c c≈©ng k d√πng ƒë∆∞·ª£c. Ph·∫£i t·∫°o token tr∆∞·ªõc trong github ƒë·ªÉ d√πng.

Organization secret s·∫Ω √°p d·ª•ng v·ªõi m·ªçi repo trong organization, ph·∫£i tr·∫£ ph√≠ m·ªõi c√≥. Repo secret free s·∫Ω ghi ƒë√® organization secret n·∫øu tr√πng t√™n.
Environment secret s·∫Ω ghi ƒë√® c·∫£ 2 repo secret v√† organization secret khi d√πng ƒë√∫ng m√¥i tr∆∞·ªùng ƒë√≥. Ch·ªâ user c√≥ quy·ªÅn m·ªõi add v√† edit ƒë∆∞·ª£c secret ƒë√≥

Secret k th·ªÉ l·∫•y ra d√πng trong app. Khi fork 1 repo, s·∫Ω k fork ƒë∆∞·ª£c secret.
C√≥ th·ªÉ d√πng secret qua API hay cli hay trong file github.action nh∆∞ng k th·ªÉ xem ƒë∆∞·ª£c gi√° tr·ªã hay in ra

T·∫°o secret: v√†o settings c·ªßa repo -> ·∫§n secrets ƒë·ªÉ d√πng secret c·ªßa repo. C√≥ th·ªÉ v√†o Environment ƒë·ªÉ t·∫°o secret cho t·ª´ng m√¥i tr∆∞·ªùng
C√≥ tool Azure key vault trong marketplace gi√∫p l·∫•y secret ra output variables c·ªßa c√°c actions ƒë·ªÉ d√πng trong workflow



# Automation Parameter.
VD ta b·∫Øt khi 1 event custom x·∫£y ra th√¨ l·∫•y gi√° tr·ªã d√πng trong workflow:
on:
  repository_dispatch:
    types: [MyCustomEventName]
Th√¨ sau ƒë√≥ ta c√≥ th·ªÉ d√πng parameter c·ªßa event trong workflow. Vd: echo ${{github.event.client_payload.testboolean}}

Trong actions ƒë·ªãnh nghƒ©a event ta c√≥ th·ªÉ ƒë·ªãnh nghƒ©a client-payload:
uses: peter-evans/repository_dispatch@v1.1.2
with: 
  token: ${{ secret.REPO.PAT }}
  event-type: MyCustomEventName
  client-payload: '{"testboolean": 123}'


# VD Th·ª±c h√†nh github actions + docker
=> ref t·ªõi "Tools / Docker / Th·ª±c h√†nh docker hub"

-> Quy tr√¨nh: Dev push code l√™n github -> Github trigger actions -> Action1 s·∫Ω push image ƒë√£ build l√™n docker hub -> Action2 s·∫Ω deploy th√¥ng qua server b√™n th·ª© 3 l√† digital ocean -> C·ª• th·ªÉ actions n√†y d√πng th·∫≥ng SSH key ƒë·ªÉ connect ƒëi·ªÅu khi·ªÉn server -> Server n√†y c√≥ hosting public nh∆∞ng k c√≥ domain, action s·∫Ω y√™u c·∫ßu n√≥ pull image m√† github v·ª´a push l√™n docker hub v·ªÅ ch·∫°y nh∆∞ trong "Tools / Docker / Th·ª±c h√†nh docker hub"

-> Deploy server v·ªõi digital ocean => B·ªè v√¨ m·∫•t ph√≠
V√†o https://cloud.digitalocean.com/projects -> create a droplet
Tutorial: https://viblo.asia/p/cicd-github-actions-va-cac-kien-thuc-co-ban-EoW4oRMrVml

N·∫øu CICD th√†nh c√¥ng m√† public ip k hi·ªÉn th·ªã khi v√†o web th√¨ AWS ph·∫£i enable t∆∞·ªùng l·ª≠a public port ra ngo√†i, v·ªõi Digital Ocean th√¨ m·∫∑c ƒë·ªãnh m·ªü m·ªçi port r
ƒêi·ªÅu ƒë·∫∑c bi·ªát l√† khi k·∫øt h·ª£p v·ªõi docker, ta k c·∫ßn quan t√¢m command tr√™n server l√† g√¨ hay hƒëh n√†o, k·ªÉ c·∫£ server m√°y window c≈©ng ƒë∆∞·ª£c, ch·ªâ c·∫ßn ch·∫°y l·ªánh c·ªßa docker l√† m·ªçi th·ª© done h·∫øt



# VD d√πng github actions t·∫°o dynamic file readme
√ù t∆∞·ªüng l√† t·∫°o ra 1 file readme template v√† code template cho file ƒë√≥ b·∫±ng markdown. R·ªìi t·∫°o 1 github actions ri√™ng nh·∫≠n data v√† filter v√†o ch·ªó tr·ªëng ƒë√≥. C√≥ th·ªÉ d√πng Go Template ƒë·ªÉ l√†m ƒëi·ªÅu n√†y
Github Actions c√≥ th·ªÉ ch·∫°y v·ªõi cron job, ta x√°c ƒë·ªãnh ktg n√≥ fetch l·∫°i data update t·ª± ƒë·ªông v√†o template cho cronjob. R·ªìi commit l√™n l√† xong.
=> Sau ƒë√≥ c·ª© m·ªói time interval cronjob s·∫Ω t·ª± ch·∫°y l·∫°i actions c·ªßa ta ƒë·ªÉ update data v√†o readme.template v√† cho ra output l√† Readme.md show ra tr√™n git.
URL: https://dev.to/jacktt/creating-dynamic-readmemd-file-388o?fbclid=IwAR2XUYI_UdIzb-Owtk4H8-JCy8zvDKLBYec5OrJLViCeb0EnkNffMTcIl-U

